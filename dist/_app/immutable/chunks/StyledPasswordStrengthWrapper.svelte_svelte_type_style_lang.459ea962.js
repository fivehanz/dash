var oe=Object.defineProperty;var ie=(e,r,a)=>r in e?oe(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a;var d=(e,r,a)=>(ie(e,typeof r!="symbol"?r+"":r,a),a);import{w as ae}from"./index.f99b4d99.js";var ne=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function se(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var B={exports:{}};(function(e,r){var a=typeof self<"u"?self:ne,c=function(){function s(){this.fetch=!1,this.DOMException=a.DOMException}return s.prototype=a,new s}();(function(s){(function(u){var y={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function A(t){return t&&DataView.prototype.isPrototypeOf(t)}if(y.arrayBuffer)var w=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],U=ArrayBuffer.isView||function(t){return t&&w.indexOf(Object.prototype.toString.call(t))>-1};function T(t){if(typeof t!="string"&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function x(t){return typeof t!="string"&&(t=String(t)),t}function k(t){var o={next:function(){var i=t.shift();return{done:i===void 0,value:i}}};return y.iterable&&(o[Symbol.iterator]=function(){return o}),o}function h(t){this.map={},t instanceof h?t.forEach(function(o,i){this.append(i,o)},this):Array.isArray(t)?t.forEach(function(o){this.append(o[0],o[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(o){this.append(o,t[o])},this)}h.prototype.append=function(t,o){t=T(t),o=x(o);var i=this.map[t];this.map[t]=i?i+", "+o:o},h.prototype.delete=function(t){delete this.map[T(t)]},h.prototype.get=function(t){return t=T(t),this.has(t)?this.map[t]:null},h.prototype.has=function(t){return this.map.hasOwnProperty(T(t))},h.prototype.set=function(t,o){this.map[T(t)]=x(o)},h.prototype.forEach=function(t,o){for(var i in this.map)this.map.hasOwnProperty(i)&&t.call(o,this.map[i],i,this)},h.prototype.keys=function(){var t=[];return this.forEach(function(o,i){t.push(i)}),k(t)},h.prototype.values=function(){var t=[];return this.forEach(function(o){t.push(o)}),k(t)},h.prototype.entries=function(){var t=[];return this.forEach(function(o,i){t.push([i,o])}),k(t)},y.iterable&&(h.prototype[Symbol.iterator]=h.prototype.entries);function P(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function j(t){return new Promise(function(o,i){t.onload=function(){o(t.result)},t.onerror=function(){i(t.error)}})}function W(t){var o=new FileReader,i=j(o);return o.readAsArrayBuffer(t),i}function K(t){var o=new FileReader,i=j(o);return o.readAsText(t),i}function X(t){for(var o=new Uint8Array(t),i=new Array(o.length),p=0;p<o.length;p++)i[p]=String.fromCharCode(o[p]);return i.join("")}function C(t){if(t.slice)return t.slice(0);var o=new Uint8Array(t.byteLength);return o.set(new Uint8Array(t)),o.buffer}function F(){return this.bodyUsed=!1,this._initBody=function(t){this._bodyInit=t,t?typeof t=="string"?this._bodyText=t:y.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:y.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():y.arrayBuffer&&y.blob&&A(t)?(this._bodyArrayBuffer=C(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):y.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||U(t))?this._bodyArrayBuffer=C(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||(typeof t=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var t=P(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?P(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(W)}),this.text=function(){var t=P(this);if(t)return t;if(this._bodyBlob)return K(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(X(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(ee)}),this.json=function(){return this.text().then(JSON.parse)},this}var Y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Z(t){var o=t.toUpperCase();return Y.indexOf(o)>-1?o:t}function m(t,o){o=o||{};var i=o.body;if(t instanceof m){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,o.headers||(this.headers=new h(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,!i&&t._bodyInit!=null&&(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=o.credentials||this.credentials||"same-origin",(o.headers||!this.headers)&&(this.headers=new h(o.headers)),this.method=Z(o.method||this.method||"GET"),this.mode=o.mode||this.mode||null,this.signal=o.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})};function ee(t){var o=new FormData;return t.trim().split("&").forEach(function(i){if(i){var p=i.split("="),f=p.shift().replace(/\+/g," "),n=p.join("=").replace(/\+/g," ");o.append(decodeURIComponent(f),decodeURIComponent(n))}}),o}function te(t){var o=new h,i=t.replace(/\r?\n[\t ]+/g," ");return i.split(/\r?\n/).forEach(function(p){var f=p.split(":"),n=f.shift().trim();if(n){var L=f.join(":").trim();o.append(n,L)}}),o}F.call(m.prototype);function g(t,o){o||(o={}),this.type="default",this.status=o.status===void 0?200:o.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in o?o.statusText:"OK",this.headers=new h(o.headers),this.url=o.url||"",this._initBody(t)}F.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},g.error=function(){var t=new g(null,{status:0,statusText:""});return t.type="error",t};var re=[301,302,303,307,308];g.redirect=function(t,o){if(re.indexOf(o)===-1)throw new RangeError("Invalid status code");return new g(null,{status:o,headers:{location:t}})},u.DOMException=s.DOMException;try{new u.DOMException}catch{u.DOMException=function(o,i){this.message=o,this.name=i;var p=Error(o);this.stack=p.stack},u.DOMException.prototype=Object.create(Error.prototype),u.DOMException.prototype.constructor=u.DOMException}function q(t,o){return new Promise(function(i,p){var f=new m(t,o);if(f.signal&&f.signal.aborted)return p(new u.DOMException("Aborted","AbortError"));var n=new XMLHttpRequest;function L(){n.abort()}n.onload=function(){var R={status:n.status,statusText:n.statusText,headers:te(n.getAllResponseHeaders()||"")};R.url="responseURL"in n?n.responseURL:R.headers.get("X-Request-URL");var $="response"in n?n.response:n.responseText;i(new g($,R))},n.onerror=function(){p(new TypeError("Network request failed"))},n.ontimeout=function(){p(new TypeError("Network request failed"))},n.onabort=function(){p(new u.DOMException("Aborted","AbortError"))},n.open(f.method,f.url,!0),f.credentials==="include"?n.withCredentials=!0:f.credentials==="omit"&&(n.withCredentials=!1),"responseType"in n&&y.blob&&(n.responseType="blob"),f.headers.forEach(function(R,$){n.setRequestHeader($,R)}),f.signal&&(f.signal.addEventListener("abort",L),n.onreadystatechange=function(){n.readyState===4&&f.signal.removeEventListener("abort",L)}),n.send(typeof f._bodyInit>"u"?null:f._bodyInit)})}return q.polyfill=!0,s.fetch||(s.fetch=q,s.Headers=h,s.Request=m,s.Response=g),u.Headers=h,u.Request=m,u.Response=g,u.fetch=q,Object.defineProperty(u,"__esModule",{value:!0}),u})({})})(c),c.fetch.ponyfill=!0,delete c.fetch.polyfill;var l=c;r=l.fetch,r.default=l.fetch,r.fetch=l.fetch,r.Headers=l.Headers,r.Request=l.Request,r.Response=l.Response,e.exports=r})(B,B.exports);var le=B.exports;const de=se(le);var ce=Object.defineProperty,_=(e,r)=>ce(e,"name",{value:r,configurable:!0}),D;(function(e){e.Apple="apple",e.Github="github",e.Google="google",e.Facebook="facebook",e.LinkedIn="linkedin"})(D||(D={}));var O;(function(e){e.Code="code",e.Token="token"})(O||(O={}));var E=_(()=>typeof window<"u","hasWindow"),z=_(e=>{let r=e.trim();return r[r.length-1]==="/"&&(r=r.slice(0,-1)),r},"trimURL"),G=_(()=>E()?window.crypto||window.msCrypto:null,"getCrypto"),ue=_(()=>{let e=G();return e&&e.subtle||e.webkitSubtle},"getCryptoSubtle"),v=_(()=>{let e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~.",r="",a=G();return a&&Array.from(a.getRandomValues(new Uint8Array(43))).forEach(c=>r+=e[c%e.length]),r},"createRandomString"),b=_(e=>E()?btoa(e):Buffer.from(e).toString("base64"),"encode"),he=_(e=>Object.keys(e).filter(r=>typeof e[r]<"u").map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(e[r])}`).join("&"),"createQueryParams"),fe=_(async e=>{let r=ue().digest({name:"SHA-256"},new TextEncoder().encode(e));return window.msCrypto?new Promise((a,c)=>{r.oncomplete=l=>{a(l.target.result)},r.onerror=l=>{c(l.error)},r.onabort=()=>{c(new Error("The digest operation was aborted"))}}):await r},"sha256"),ye=_(e=>{let r={"+":"-","/":"_","=":""};return e.replace(/[+/=]/g,a=>r[a])},"urlEncodeB64"),pe=_(e=>{let r=new Uint8Array(e);return ye(window.btoa(String.fromCharCode(...Array.from(r))))},"bufferToBase64UrlEncoded"),_e=_((e,r,a=60)=>new Promise((c,l)=>{let s=window.document.createElement("iframe");s.setAttribute("id","authorizer-iframe"),s.setAttribute("width","0"),s.setAttribute("height","0"),s.style.display="none";let u,y=_(()=>{window.document.body.contains(s)&&(window.document.body.removeChild(s),window.removeEventListener("message",u,!1))},"removeIframe"),A=setTimeout(()=>{y()},a*1e3);u=_(function(w){if(w.origin!==r||!w.data||!w.data.response)return;let U=w.source;U&&U.close(),w.data.response.error?l(w.data.response):c(w.data.response),clearTimeout(A),window.removeEventListener("message",u,!1),setTimeout(y,2*1e3)},"iframeEventHandler"),window.addEventListener("message",u,!1),window.document.body.appendChild(s),s.setAttribute("src",e)}),"executeIframe"),V="id email email_verified given_name family_name middle_name nickname preferred_username picture signup_methods gender birthdate phone_number phone_number_verified roles created_at updated_at is_multi_factor_auth_enabled ",S=`message access_token expires_in refresh_token id_token should_show_otp_screen user { ${V} }`,I=_(()=>E()?window.fetch:de,"getFetcher"),J=class{constructor(e){d(this,"authorize",async e=>{if(!E())throw new Error("this feature is only supported in browser");let r=["openid","profile","email"];e.use_refresh_token&&r.push("offline_access");let a={redirect_uri:this.config.redirectURL,response_mode:e.response_mode||"web_message",state:b(v()),nonce:b(v()),response_type:e.response_type,scope:r.join(" "),client_id:this.config.clientID};if(e.response_type===O.Code){this.codeVerifier=v();let l=await fe(this.codeVerifier),s=pe(l);a.code_challenge=s}let c=`${this.config.authorizerURL}/authorize?${he(a)}`;if(a.response_mode!=="web_message"){window.location.replace(c);return}try{let l=await _e(c,this.config.authorizerURL,60);return e.response_type===O.Code?await this.getToken({code:l.code}):l}catch(l){throw l.error&&window.location.replace(`${this.config.authorizerURL}/app?state=${b(JSON.stringify(this.config))}&redirect_uri=${this.config.redirectURL}`),l}});d(this,"browserLogin",async()=>{try{return await this.getSession()}catch{if(!E())throw new Error("browserLogin is only supported for browsers");window.location.replace(`${this.config.authorizerURL}/app?state=${b(JSON.stringify(this.config))}&redirect_uri=${this.config.redirectURL}`)}});d(this,"forgotPassword",async e=>{e.state||(e.state=b(v())),e.redirect_uri||(e.redirect_uri=this.config.redirectURL);try{return(await this.graphqlQuery({query:"mutation forgotPassword($data: ForgotPasswordInput!) {	forgot_password(params: $data) { message } }",variables:{data:e}})).forgot_password}catch(r){throw new Error(r)}});d(this,"getMetaData",async()=>{try{return(await this.graphqlQuery({query:"query { meta { version is_google_login_enabled is_facebook_login_enabled is_github_login_enabled is_linkedin_login_enabled is_apple_login_enabled is_twitter_login_enabled is_microsoft_login_enabled is_email_verification_enabled is_basic_authentication_enabled is_magic_link_login_enabled is_sign_up_enabled is_strong_password_enabled } }"})).meta}catch(e){throw new Error(e)}});d(this,"getProfile",async e=>{try{return(await this.graphqlQuery({query:`query {	profile { ${V} } }`,headers:e})).profile}catch(r){throw new Error(r)}});d(this,"getSession",async(e,r)=>{try{return(await this.graphqlQuery({query:`query getSession($params: SessionQueryInput){session(params: $params) { ${S} } }`,headers:e,variables:{params:r}})).session}catch(a){throw new Error(a)}});d(this,"getToken",async e=>{if(e.grant_type||(e.grant_type="authorization_code"),e.grant_type==="refresh_token"&&!e.refresh_token)throw new Error("Invalid refresh_token");if(e.grant_type==="authorization_code"&&!this.codeVerifier)throw new Error("Invalid code verifier");let r={client_id:this.config.clientID,code:e.code||"",code_verifier:this.codeVerifier||"",grant_type:e.grant_type||"",refresh_token:e.refresh_token||""};try{let a=await I()(`${this.config.authorizerURL}/oauth/token`,{method:"POST",body:JSON.stringify(r),headers:{...this.config.extraHeaders},credentials:"include"}),c=await a.json();if(a.status>=400)throw new Error(c);return c}catch(a){throw new Error(a)}});d(this,"graphqlQuery",async e=>{let r=await(await I()(`${this.config.authorizerURL}/graphql`,{method:"POST",body:JSON.stringify({query:e.query,variables:e.variables||{}}),headers:{...this.config.extraHeaders,...e.headers||{}},credentials:"include"})).json();if(r.errors&&r.errors.length)throw console.error(r.errors),new Error(r.errors[0].message);return r.data});d(this,"login",async e=>{try{return(await this.graphqlQuery({query:`
					mutation login($data: LoginInput!) { login(params: $data) { ${S}}}
				`,variables:{data:e}})).login}catch(r){throw new Error(r)}});d(this,"logout",async e=>{try{return(await this.graphqlQuery({query:" mutation { logout { message } } ",headers:e})).logout}catch(r){console.error(r)}});d(this,"magicLinkLogin",async e=>{try{return e.state||(e.state=b(v())),e.redirect_uri||(e.redirect_uri=this.config.redirectURL),(await this.graphqlQuery({query:`
					mutation magicLinkLogin($data: MagicLinkLoginInput!) { magic_link_login(params: $data) { message }}
				`,variables:{data:e}})).magic_link_login}catch(r){throw new Error(r)}});d(this,"oauthLogin",async(e,r,a,c)=>{let l=c;if(l||(l=b(v())),!Object.values(D).includes(e))throw new Error(`only following oauth providers are supported: ${Object.values(e).toString()}`);if(!E())throw new Error("oauthLogin is only supported for browsers");window.location.replace(`${this.config.authorizerURL}/oauth_login/${e}?redirect_uri=${a||this.config.redirectURL}&state=${l}${r&&r.length?`&roles=${r.join(",")}`:""}`)});d(this,"resendOtp",async e=>{try{return(await this.graphqlQuery({query:`
					mutation resendOtp($data: ResendOTPRequest!) { resend_otp(params: $data) { message }}
				`,variables:{data:e}})).resend_otp}catch(r){throw new Error(r)}});d(this,"resetPassword",async e=>{try{return(await this.graphqlQuery({query:"mutation resetPassword($data: ResetPasswordInput!) {	reset_password(params: $data) { message } }",variables:{data:e}})).reset_password}catch(r){throw new Error(r)}});d(this,"revokeToken",async e=>{if(!e.refresh_token&&!e.refresh_token.trim())throw new Error("Invalid refresh_token");return await(await I()(`${this.config.authorizerURL}/oauth/revoke`,{method:"POST",headers:{...this.config.extraHeaders},body:JSON.stringify({refresh_token:e.refresh_token,client_id:this.config.clientID})})).json()});d(this,"signup",async e=>{try{return(await this.graphqlQuery({query:`
					mutation signup($data: SignUpInput!) { signup(params: $data) { ${S}}}
				`,variables:{data:e}})).signup}catch(r){throw new Error(r)}});d(this,"updateProfile",async(e,r)=>{try{return(await this.graphqlQuery({query:"mutation updateProfile($data: UpdateProfileInput!) {	update_profile(params: $data) { message } }",headers:r,variables:{data:e}})).update_profile}catch(a){throw new Error(a)}});d(this,"validateJWTToken",async e=>{try{return(await this.graphqlQuery({query:"query validateJWTToken($params: ValidateJWTTokenInput!){validate_jwt_token(params: $params) { is_valid claims } }",variables:{params:e}})).validate_jwt_token}catch(r){throw new Error(r)}});d(this,"verifyEmail",async e=>{try{return(await this.graphqlQuery({query:`
					mutation verifyEmail($data: VerifyEmailInput!) { verify_email(params: $data) { ${S}}}
				`,variables:{data:e}})).verify_email}catch(r){throw new Error(r)}});d(this,"verifyOtp",async e=>{try{return(await this.graphqlQuery({query:`
					mutation verifyOtp($data: VerifyOTPRequest!) { verify_otp(params: $data) { ${S}}}
				`,variables:{data:e}})).verify_otp}catch(r){throw new Error(r)}});if(!e)throw new Error("Configuration is required");if(this.config=e,!e.authorizerURL&&!e.authorizerURL.trim())throw new Error("Invalid authorizerURL");if(e.authorizerURL&&(this.config.authorizerURL=z(e.authorizerURL)),!e.redirectURL&&!e.redirectURL.trim())throw new Error("Invalid redirectURL");this.config.redirectURL=z(e.redirectURL),this.config.extraHeaders={...e.extraHeaders||{},"x-authorizer-url":this.config.authorizerURL,"Content-Type":"application/json"},this.config.clientID=e.clientID.trim()}};_(J,"Authorizer");const ge=()=>typeof window<"u",be=ae({config:{authorizerURL:"",redirectURL:"/",client_id:"",is_google_login_enabled:!1,is_github_login_enabled:!1,is_facebook_login_enabled:!1,is_linkedin_login_enabled:!1,is_apple_login_enabled:!1,is_twitter_login_enabled:!1,is_microsoft_login_enabled:!1,is_email_verification_enabled:!1,is_basic_authentication_enabled:!1,is_magic_link_login_enabled:!1,is_sign_up_enabled:!1,is_strong_password_enabled:!0},user:null,token:null,loading:!1,setLoading:()=>{},setToken:()=>{},setUser:()=>{},setAuthData:()=>{},authorizerRef:new J({authorizerURL:"http://localhost:8080",redirectURL:ge()?window.location.origin:"/",clientID:""}),logout:async()=>{}});var H;(function(e){e[e.Login=0]="Login",e[e.Signup=1]="Signup",e[e.ForgotPassword=2]="ForgotPassword"})(H||(H={}));var M;(function(e){e[e.Primary=0]="Primary",e[e.Default=1]="Default"})(M||(M={}));var N;(function(e){e[e.Error=0]="Error",e[e.Success=1]="Success"})(N||(N={}));var Q;(function(e){e.SET_USER="SET_USER",e.SET_TOKEN="SET_TOKEN",e.SET_LOADING="SET_LOADING",e.SET_AUTH_DATA="SET_AUTH_DATA",e.SET_CONFIG="SET_CONFIG"})(Q||(Q={}));const ve={default:.15,weak:.4,good:.6,strong:.8,veryStrong:1};export{Q as A,M as B,N as M,H as V,ge as h,J as m,ve as p,be as s};
